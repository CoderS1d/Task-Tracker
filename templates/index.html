<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.css' rel='stylesheet'>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/calendar.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/schedule.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/calendar-counts.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/task-schedule.css') }}">
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.js'></script>
    <script id="scheduleData" type="application/json">
        {{ schedule | tojson | safe }}
    </script>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-3 sidebar">
                <h2 class="text-center my-4">Task Tracker</h2>
                <div class="calendar-wrapper">
                    <div class="calendar-nav d-flex justify-content-between align-items-center mb-2">
                        <button class="btn btn-sm btn-outline-secondary" id="prevMonth">&lt;</button>
                        <h5 class="mb-0" id="calendarTitle"></h5>
                        <button class="btn btn-sm btn-outline-secondary" id="nextMonth">&gt;</button>
                    </div>
                    <!-- Calendar view options removed, using month view only -->
                    <div class="calendar-container mb-4">
                        <div id="calendar"></div>
                    </div>
                </div>
                <div class="streak-container">
                    <h4>Streak Statistics</h4>
                    <div class="streak-stats">
                        <div id="streakChart"></div>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-md-9 main-content">
                <div class="row mt-4">
                    <div class="col-12">
                        <h3>Today's Schedule - <span id="currentDate"></span></h3>
                        <div class="schedule-container mb-4">
                            <div id="dailySchedule"></div>
                        </div>
                    </div>
                </div>

                <div class="task-schedule-container">
                    <div class="card mb-3">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h4 class="mb-0">Tasks</h4>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addTaskModal">
                                Add Task
                            </button>
                        </div>
                        <div class="card-body p-0">
                            <div id="taskList" class="task-list-container"></div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h4 class="mb-0">Weekly Schedule</h4>
                            <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addScheduleModal">
                                Add Schedule Item
                            </button>
                        </div>
                        <div class="card-body p-0">
                            <div id="weeklySchedule" class="accordion"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Task Modal -->
    <div class="modal fade" id="addTaskModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add New Task</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addTaskForm">
                        <div class="mb-3">
                            <label for="taskTitle" class="form-label">Task Title</label>
                            <input type="text" class="form-control" id="taskTitle" required>
                        </div>
                        <div class="mb-3">
                            <label for="taskDate" class="form-label">Date</label>
                            <input type="date" class="form-control" id="taskDate" required>
                        </div>
                        <div class="mb-3">
                            <label for="taskCategory" class="form-label">Category</label>
                            <select class="form-control" id="taskCategory">
                                <option value="General">General</option>
                                <option value="Study">Study</option>
                                <option value="Work">Work</option>
                                <option value="Project">Project</option>
                                <option value="Startup">Startup</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="taskPriority" class="form-label">Priority</label>
                            <select class="form-control" id="taskPriority">
                                <option value="High">High</option>
                                <option value="Medium" selected>Medium</option>
                                <option value="Low">Low</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="taskTimeSlot" class="form-label">Time Slot</label>
                            <select class="form-control" id="taskTimeSlot">
                                <option value="">Select Time Slot</option>
                                <option value="00:00-01:00">12:00 AM - 1:00 AM</option>
                                <option value="01:00-02:00">1:00 AM - 2:00 AM</option>
                                <option value="02:00-03:00">2:00 AM - 3:00 AM</option>
                                <option value="03:00-04:00">3:00 AM - 4:00 AM</option>
                                <option value="04:00-05:00">4:00 AM - 5:00 AM</option>
                                <option value="05:00-06:00">5:00 AM - 6:00 AM</option>
                                <option value="06:00-07:00">6:00 AM - 7:00 AM</option>
                                <option value="07:00-08:00">7:00 AM - 8:00 AM</option>
                                <option value="08:00-09:00">8:00 AM - 9:00 AM</option>
                                <option value="09:00-10:00">9:00 AM - 10:00 AM</option>
                                <option value="10:00-11:00">10:00 AM - 11:00 AM</option>
                                <option value="11:00-12:00">11:00 AM - 12:00 PM</option>
                                <option value="12:00-13:00">12:00 PM - 1:00 PM</option>
                                <option value="13:00-14:00">1:00 PM - 2:00 PM</option>
                                <option value="14:00-15:00">2:00 PM - 3:00 PM</option>
                                <option value="15:00-16:00">3:00 PM - 4:00 PM</option>
                                <option value="16:00-17:00">4:00 PM - 5:00 PM</option>
                                <option value="17:00-18:00">5:00 PM - 6:00 PM</option>
                                <option value="18:00-19:00">6:00 PM - 7:00 PM</option>
                                <option value="19:00-20:00">7:00 PM - 8:00 PM</option>
                                <option value="20:00-21:00">8:00 PM - 9:00 PM</option>
                                <option value="21:00-22:00">9:00 PM - 10:00 PM</option>
                                <option value="22:00-23:00">10:00 PM - 11:00 PM</option>
                                <option value="23:00-00:00">11:00 PM - 12:00 AM</option>
                            </select>
                            </div>
                            
                            <div id="customTimeSection" style="display: none;">
                                <div class="row">
                                    <div class="col-6">
                                        <label for="customStartTime" class="form-label">Start Time</label>
                                        <input type="time" class="form-control" id="customStartTime">
                                    </div>
                                    <div class="col-6">
                                        <label for="customEndTime" class="form-label">End Time</label>
                                        <input type="time" class="form-control" id="customEndTime">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <input type="hidden" id="taskId">
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="saveTask">Save Task</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit Schedule Modal -->
    <div class="modal fade" id="addScheduleModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Add Schedule Item</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="addScheduleForm">
                        <input type="hidden" id="scheduleOriginalDay">
                        <input type="hidden" id="scheduleOriginalTime">
                        <input type="hidden" id="scheduleOriginalTask">
                        <div class="mb-3">
                            <label for="scheduleTask" class="form-label">Task Description</label>
                            <input type="text" class="form-control" id="scheduleTask" placeholder="Enter task description" required>
                        </div>
                        <div class="mb-3">
                            <label for="scheduleDay" class="form-label">Day</label>
                            <select class="form-control" id="scheduleDay" required>
                                <option value="">Select Day</option>
                                <option value="Monday">Monday</option>
                                <option value="Tuesday">Tuesday</option>
                                <option value="Wednesday">Wednesday</option>
                                <option value="Thursday">Thursday</option>
                                <option value="Friday">Friday</option>
                                <option value="Saturday">Saturday</option>
                                <option value="Sunday">Sunday</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <div id="timeSelectionOptions">
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="radio" name="timeOption" id="keepExistingTime" value="keep">
                                    <label class="form-check-label" for="keepExistingTime">
                                        Keep existing time
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="radio" name="timeOption" id="usePresetTime" value="preset" checked>
                                    <label class="form-check-label" for="usePresetTime">
                                        Use preset time slots
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="radio" name="timeOption" id="useCustomTime" value="custom">
                                    <label class="form-check-label" for="useCustomTime">
                                        Use custom time
                                    </label>
                                </div>
                            </div>
                            
                            <div id="presetTimeSection">
                                <label for="scheduleTime" class="form-label">Time</label>
                                <select class="form-control" id="scheduleTime" required>
                                    <option value="">Select Time Slot</option>
                                    <option value="00:00-01:00">12:00 AM - 1:00 AM</option>
                                    <option value="01:00-02:00">1:00 AM - 2:00 AM</option>
                                    <option value="02:00-03:00">2:00 AM - 3:00 AM</option>
                                    <option value="03:00-04:00">3:00 AM - 4:00 AM</option>
                                    <option value="04:00-05:00">4:00 AM - 5:00 AM</option>
                                <option value="05:00-06:00">5:00 AM - 6:00 AM</option>
                                <option value="06:00-07:00">6:00 AM - 7:00 AM</option>
                                <option value="07:00-08:00">7:00 AM - 8:00 AM</option>
                                <option value="08:00-09:00">8:00 AM - 9:00 AM</option>
                                <option value="09:00-10:00">9:00 AM - 10:00 AM</option>
                                <option value="10:00-11:00">10:00 AM - 11:00 AM</option>
                                <option value="11:00-12:00">11:00 AM - 12:00 PM</option>
                                <option value="12:00-13:00">12:00 PM - 1:00 PM</option>
                                <option value="13:00-14:00">1:00 PM - 2:00 PM</option>
                                <option value="14:00-15:00">2:00 PM - 3:00 PM</option>
                                <option value="15:00-16:00">3:00 PM - 4:00 PM</option>
                                <option value="16:00-17:00">4:00 PM - 5:00 PM</option>
                                <option value="17:00-18:00">5:00 PM - 6:00 PM</option>
                                <option value="18:00-19:00">6:00 PM - 7:00 PM</option>
                                <option value="19:00-20:00">7:00 PM - 8:00 PM</option>
                                <option value="20:00-21:00">8:00 PM - 9:00 PM</option>
                                <option value="21:00-22:00">9:00 PM - 10:00 PM</option>
                                <option value="22:00-23:00">10:00 PM - 11:00 PM</option>
                                <option value="23:00-00:00">11:00 PM - 12:00 AM</option>
                                <option value="Flexible">Flexible Time</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="saveSchedule">Save Schedule</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>